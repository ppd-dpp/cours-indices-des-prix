<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Exemple avec R | Un cours sur les indices des prix</title>
  <meta name="description" content="Une introduction moderne et simple aux indices des prix" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Exemple avec R | Un cours sur les indices des prix" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Une introduction moderne et simple aux indices des prix" />
  <meta name="github-repo" content="ppd-dpp/cours-indices-des-prix" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Exemple avec R | Un cours sur les indices des prix" />
  
  <meta name="twitter:description" content="Une introduction moderne et simple aux indices des prix" />
  

<meta name="author" content="Steve Martin et Rebecca Meier" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="lapproche-temporelle.html"/>
<link rel="next" href="affectation-2.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="align.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Aperçu</a></li>
<li class="part"><span><b>I Introduction aux indices de prix</b></span></li>
<li class="chapter" data-level="" data-path="programme.html"><a href="programme.html"><i class="fa fa-check"></i>Programme</a></li>
<li class="chapter" data-level="" data-path="quest-ce-quun-indice-des-prix-et-pourquoi-en-avons-nous-besoin.html"><a href="quest-ce-quun-indice-des-prix-et-pourquoi-en-avons-nous-besoin.html"><i class="fa fa-check"></i>Qu’est-ce qu’un indice des prix et pourquoi en avons-nous besoin?</a><ul>
<li class="chapter" data-level="" data-path="quest-ce-quun-indice-des-prix.html"><a href="quest-ce-quun-indice-des-prix.html"><i class="fa fa-check"></i>Qu’est-ce qu’un indice des prix?</a></li>
<li class="chapter" data-level="" data-path="utilisations-dun-indice-des-prix.html"><a href="utilisations-dun-indice-des-prix.html"><i class="fa fa-check"></i>Utilisations d’un indice des prix</a></li>
<li class="chapter" data-level="" data-path="pourquoi-un-indice-des-prix.html"><a href="pourquoi-un-indice-des-prix.html"><i class="fa fa-check"></i>Pourquoi un indice des prix?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="formule-de-numéro-dindex.html"><a href="formule-de-numéro-dindex.html"><i class="fa fa-check"></i>Formule de numéro d’index</a><ul>
<li class="chapter" data-level="" data-path="indices-arithmétiques-des-prix.html"><a href="indices-arithmétiques-des-prix.html"><i class="fa fa-check"></i>Indices arithmétiques des prix</a></li>
<li class="chapter" data-level="" data-path="indices-arithmétiques-communs.html"><a href="indices-arithmétiques-communs.html"><i class="fa fa-check"></i>Indices arithmétiques communs</a></li>
<li class="chapter" data-level="" data-path="indices-arithmétiques-moins-courants.html"><a href="indices-arithmétiques-moins-courants.html"><i class="fa fa-check"></i>Indices arithmétiques moins courants</a></li>
<li class="chapter" data-level="" data-path="indices-géométriques-des-prix.html"><a href="indices-géométriques-des-prix.html"><i class="fa fa-check"></i>Indices géométriques des prix</a></li>
<li class="chapter" data-level="" data-path="lindice-fisher.html"><a href="lindice-fisher.html"><i class="fa fa-check"></i>L’indice Fisher</a></li>
<li class="chapter" data-level="" data-path="exemple-avec-r.html"><a href="exemple-avec-r.html"><i class="fa fa-check"></i>Exemple avec R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="calcul-dun-indice-des-prix.html"><a href="calcul-dun-indice-des-prix.html"><i class="fa fa-check"></i>Calcul d’un indice des prix</a><ul>
<li class="chapter" data-level="" data-path="sous-indices-et-agrégation.html"><a href="sous-indices-et-agrégation.html"><i class="fa fa-check"></i>Sous-indices et agrégation</a></li>
<li class="chapter" data-level="" data-path="factorisation-dun-index.html"><a href="factorisation-dun-index.html"><i class="fa fa-check"></i>Factorisation d’un index</a></li>
<li class="chapter" data-level="" data-path="rebasing.html"><a href="rebasing.html"><i class="fa fa-check"></i>Rebasing</a></li>
<li class="chapter" data-level="" data-path="chaînage.html"><a href="chaînage.html"><i class="fa fa-check"></i>Chaînage</a></li>
<li class="chapter" data-level="" data-path="exemple-avec-r-1.html"><a href="exemple-avec-r-1.html"><i class="fa fa-check"></i>Exemple avec R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="affectation.html"><a href="affectation.html"><i class="fa fa-check"></i>Affectation</a></li>
<li class="part"><span><b>II Théorie de l’indice des prix</b></span></li>
<li class="chapter" data-level="" data-path="programme-1.html"><a href="programme-1.html"><i class="fa fa-check"></i>Programme</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="lapproche-axiomatique.html"><a href="lapproche-axiomatique.html"><i class="fa fa-check"></i>L’approche axiomatique</a><ul>
<li class="chapter" data-level="" data-path="un-indice-de-prix-abstrait.html"><a href="un-indice-de-prix-abstrait.html"><i class="fa fa-check"></i>Un indice de prix abstrait</a></li>
<li class="chapter" data-level="" data-path="les-axiomes.html"><a href="les-axiomes.html"><i class="fa fa-check"></i>Les axiomes</a></li>
<li class="chapter" data-level="" data-path="exemples-de-compteur.html"><a href="exemples-de-compteur.html"><i class="fa fa-check"></i>Exemples de compteur</a></li>
<li class="chapter" data-level="" data-path="les-tests.html"><a href="les-tests.html"><i class="fa fa-check"></i>Les tests</a></li>
<li class="chapter" data-level="" data-path="un-résultat-impossible.html"><a href="un-résultat-impossible.html"><i class="fa fa-check"></i>Un résultat impossible</a></li>
<li class="chapter" data-level="" data-path="motiver-les-indices-jevons-et-laspeyres.html"><a href="motiver-les-indices-jevons-et-laspeyres.html"><i class="fa fa-check"></i>Motiver les indices Jevons et Laspeyres</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="lapproche-économique.html"><a href="lapproche-économique.html"><i class="fa fa-check"></i>L’approche économique</a><ul>
<li class="chapter" data-level="" data-path="indice-des-prix-des-intrants.html"><a href="indice-des-prix-des-intrants.html"><i class="fa fa-check"></i>Indice des prix des intrants</a></li>
<li class="chapter" data-level="" data-path="indice-des-prix-à-la-production.html"><a href="indice-des-prix-à-la-production.html"><i class="fa fa-check"></i>Indice des prix à la production</a></li>
<li class="chapter" data-level="" data-path="indice-du-coût-de-la-vie.html"><a href="indice-du-coût-de-la-vie.html"><i class="fa fa-check"></i>Indice du coût de la vie</a></li>
<li class="chapter" data-level="" data-path="approximation-dun-indice-économique.html"><a href="approximation-dun-indice-économique.html"><i class="fa fa-check"></i>Approximation d’un indice économique</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="lapproche-stochastique.html"><a href="lapproche-stochastique.html"><i class="fa fa-check"></i>L’approche stochastique</a><ul>
<li class="chapter" data-level="" data-path="le-problème-de-prédiction-optimal.html"><a href="le-problème-de-prédiction-optimal.html"><i class="fa fa-check"></i>Le problème de prédiction optimal</a></li>
<li class="chapter" data-level="" data-path="indices-géométriques-des-prix-1.html"><a href="indices-géométriques-des-prix-1.html"><i class="fa fa-check"></i>Indices géométriques des prix</a></li>
<li class="chapter" data-level="" data-path="des-indices-de-prix-plus-généraux.html"><a href="des-indices-de-prix-plus-généraux.html"><i class="fa fa-check"></i>Des indices de prix plus généraux</a></li>
<li class="chapter" data-level="" data-path="inférence-statistique.html"><a href="inférence-statistique.html"><i class="fa fa-check"></i>Inférence statistique</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="affectation-1.html"><a href="affectation-1.html"><i class="fa fa-check"></i>Affectation</a></li>
<li class="part"><span><b>III Indices de prix de qualité constante</b></span></li>
<li class="chapter" data-level="" data-path="programme-2.html"><a href="programme-2.html"><i class="fa fa-check"></i>Programme</a></li>
<li class="chapter" data-level="" data-path="introduction-1.html"><a href="introduction-1.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="prix-potentiels.html"><a href="prix-potentiels.html"><i class="fa fa-check"></i>Prix potentiels</a><ul>
<li class="chapter" data-level="" data-path="indices-de-prix-de-qualité-constante.html"><a href="indices-de-prix-de-qualité-constante.html"><i class="fa fa-check"></i>Indices de prix de qualité constante</a></li>
<li class="chapter" data-level="" data-path="indices-de-prix-de-transaction.html"><a href="indices-de-prix-de-transaction.html"><i class="fa fa-check"></i>Indices de prix de transaction</a></li>
<li class="chapter" data-level="" data-path="identification.html"><a href="identification.html"><i class="fa fa-check"></i>Identification</a></li>
<li class="chapter" data-level="" data-path="exemple.html"><a href="exemple.html"><i class="fa fa-check"></i>Exemple</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="indices-de-prix-stratifiés.html"><a href="indices-de-prix-stratifiés.html"><i class="fa fa-check"></i>Indices de prix stratifiés</a><ul>
<li class="chapter" data-level="" data-path="indépendance-conditionnelle.html"><a href="indépendance-conditionnelle.html"><i class="fa fa-check"></i>Indépendance conditionnelle</a></li>
<li class="chapter" data-level="" data-path="chevauchement.html"><a href="chevauchement.html"><i class="fa fa-check"></i>Chevauchement</a></li>
<li class="chapter" data-level="" data-path="problèmes-de-stratification.html"><a href="problèmes-de-stratification.html"><i class="fa fa-check"></i>Problèmes de stratification</a></li>
<li class="chapter" data-level="" data-path="exemple-avec-r-2.html"><a href="exemple-avec-r-2.html"><i class="fa fa-check"></i>Exemple avec R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="indices-de-prix-hédoniques.html"><a href="indices-de-prix-hédoniques.html"><i class="fa fa-check"></i>Indices de prix hédoniques</a><ul>
<li class="chapter" data-level="" data-path="indices-hédoniques-linéaires.html"><a href="indices-hédoniques-linéaires.html"><i class="fa fa-check"></i>Indices hédoniques linéaires</a></li>
<li class="chapter" data-level="" data-path="lapproche-temporelle.html"><a href="lapproche-temporelle.html"><i class="fa fa-check"></i>L’approche temporelle</a></li>
<li class="chapter" data-level="" data-path="exemple-avec-r-3.html"><a href="exemple-avec-r-3.html"><i class="fa fa-check"></i>Exemple avec R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="affectation-2.html"><a href="affectation-2.html"><i class="fa fa-check"></i>Affectation</a></li>
<li class="part"><span><b>IV Construire un indice des prix avec R</b></span></li>
<li class="chapter" data-level="" data-path="programme-3.html"><a href="programme-3.html"><i class="fa fa-check"></i>Programme</a></li>
<li class="chapter" data-level="" data-path="affectation-3.html"><a href="affectation-3.html"><i class="fa fa-check"></i>Affectation</a><ul>
<li class="chapter" data-level="" data-path="méthodologie.html"><a href="méthodologie.html"><i class="fa fa-check"></i>Méthodologie</a></li>
<li class="chapter" data-level="" data-path="instructions.html"><a href="instructions.html"><i class="fa fa-check"></i>Instructions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="références.html"><a href="références.html"><i class="fa fa-check"></i>Références</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Un cours sur les indices des prix</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="exemple-avec-r-3" class="section level2">
<h2>Exemple avec R</h2>
<p>Le calcul d’un indice de prix hédonique linéaire est très facile dans R.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="co"># Apportez quelques données</span></a>
<a class="sourceLine" id="cb27-2" title="2">df &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;csv/data.csv&quot;</span>)</a>
<a class="sourceLine" id="cb27-3" title="3">df</a></code></pre></div>
<pre><code>##    period price chicken liver salmon
## 1       0     2       1     0      0
## 2       0     4       1     0      0
## 3       0     3       1     0      0
## 4       0     4       1     0      0
## 5       0     5       1     0      0
## 6       0     1       0     1      0
## 7       0     3       0     1      0
## 8       0     2       0     1      0
## 9       0     1       0     1      0
## 10      0     1       0     1      0
## 11      0     5       0     0      1
## 12      0     7       0     0      1
## 13      0     8       0     0      1
## 14      0     4       0     0      1
## 15      1     5       1     0      0
## 16      1     3       1     0      0
## 17      1     2       0     1      0
## 18      1     2       0     1      0
## 19      1     1       0     1      0
## 20      1     3       0     1      0
## 21      1     1       0     1      0
## 22      1     1       0     1      0
## 23      1     9       0     0      1
## 24      1     8       0     0      1
## 25      1     5       0     0      1</code></pre>
<p>Il s’agit d’un ensemble de données simple pour la nourriture pour chat, avec trois caractéristiques — est-ce de la nourriture pour chat de poulet, de la nourriture pour chat de foie ou de la nourriture pour chat de saumon? Pour évaluer l’impact d’un indice de prix hédonique, il est utile de calculer un indice de prix de transaction simple en regroupant les transactions pour les trois types d’aliments pour chats ensemble.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="co"># Calculer l&#39;indice de prix commun</span></a>
<a class="sourceLine" id="cb29-2" title="2">pooled &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(price) <span class="op">~</span><span class="st"> </span>period, df)</a>
<a class="sourceLine" id="cb29-3" title="3"><span class="kw">exp</span>(<span class="kw">coef</span>(pooled)[<span class="dv">2</span>]) <span class="op">*</span><span class="st"> </span><span class="dv">100</span></a></code></pre></div>
<pre><code>##   period 
## 93.86748</code></pre>
<p>L’indice hédonique linéaire général est facile à calculer avec une simple régression linéaire. La seule astuce consiste à se souvenir de supprimer la moyenne de chaque caractéristique dans le terme d’interaction.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="co"># Calculer l&#39;indice d&#39;imputation hédonique</span></a>
<a class="sourceLine" id="cb31-2" title="2">hedonic_imputation &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(price) <span class="op">~</span><span class="st"> </span>period <span class="op">+</span><span class="st"> </span>liver <span class="op">+</span><span class="st"> </span>salmon <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb31-3" title="3"><span class="st">                           </span>period<span class="op">:</span>(<span class="kw">I</span>(liver <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(liver)) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(salmon <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(salmon))), </a>
<a class="sourceLine" id="cb31-4" title="4">                         df)</a>
<a class="sourceLine" id="cb31-5" title="5"><span class="kw">exp</span>(<span class="kw">coef</span>(hedonic_imputation)[<span class="dv">2</span>]) <span class="op">*</span><span class="st"> </span><span class="dv">100</span></a></code></pre></div>
<pre><code>##   period 
## 112.2817</code></pre>
<p>C’est le même que le calcul en deux étapes qui est normalement effectué pour un indice d’imputation hédonique.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="co"># Régression période 0</span></a>
<a class="sourceLine" id="cb33-2" title="2">hi0 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(price) <span class="op">~</span><span class="st"> </span>liver <span class="op">+</span><span class="st"> </span>salmon, df, <span class="dt">subset =</span> period <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb33-3" title="3"></a>
<a class="sourceLine" id="cb33-4" title="4"><span class="co"># Régression de la période 1</span></a>
<a class="sourceLine" id="cb33-5" title="5">hi1 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(price) <span class="op">~</span><span class="st"> </span>liver <span class="op">+</span><span class="st"> </span>salmon, df, <span class="dt">subset =</span> period <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb33-6" title="6"></a>
<a class="sourceLine" id="cb33-7" title="7"><span class="co"># Calculer l&#39;indice à l&#39;aide des prix prévus</span></a>
<a class="sourceLine" id="cb33-8" title="8"><span class="kw">exp</span>(<span class="kw">mean</span>(<span class="kw">predict</span>(hi1, df) <span class="op">-</span><span class="st"> </span><span class="kw">predict</span>(hi0, df))) <span class="op">*</span><span class="st"> </span><span class="dv">100</span></a></code></pre></div>
<pre><code>## [1] 112.2817</code></pre>
<p>C’est également la même chose que le calcul manuel de l’indice stratifié.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="co"># Apportez dans la bibliothèque gpindex</span></a>
<a class="sourceLine" id="cb35-2" title="2"><span class="kw">library</span>(gpindex)</a>
<a class="sourceLine" id="cb35-3" title="3"></a>
<a class="sourceLine" id="cb35-4" title="4"><span class="co"># Poids de la nourriture pour chats par sa fréquence</span></a>
<a class="sourceLine" id="cb35-5" title="5">weights &lt;-<span class="st"> </span><span class="kw">colSums</span>(df[<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)])</a>
<a class="sourceLine" id="cb35-6" title="6"></a>
<a class="sourceLine" id="cb35-7" title="7"><span class="co"># Calculer un indice pour chaque type de nourriture pour chat</span></a>
<a class="sourceLine" id="cb35-8" title="8">strata_indices &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb35-9" title="9"><span class="st">  </span><span class="kw">sapply</span>(<span class="kw">list</span>(<span class="kw">subset</span>(df, chicken <span class="op">==</span><span class="st"> </span><span class="dv">1</span>), </a>
<a class="sourceLine" id="cb35-10" title="10">              <span class="kw">subset</span>(df, liver <span class="op">==</span><span class="st"> </span><span class="dv">1</span>), </a>
<a class="sourceLine" id="cb35-11" title="11">              <span class="kw">subset</span>(df, salmon <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb35-12" title="12">         <span class="cf">function</span>(x) <span class="kw">with</span>(x, <span class="kw">mean_geometric</span>(price[period <span class="op">==</span><span class="st"> </span><span class="dv">1</span>]) <span class="op">/</span><span class="st"> </span><span class="kw">mean_geometric</span>(price[period <span class="op">==</span><span class="st"> </span><span class="dv">0</span>]))</a>
<a class="sourceLine" id="cb35-13" title="13">         )</a>
<a class="sourceLine" id="cb35-14" title="14"></a>
<a class="sourceLine" id="cb35-15" title="15"><span class="co"># Agrégat</span></a>
<a class="sourceLine" id="cb35-16" title="16"><span class="kw">mean_geometric</span>(strata_indices, weights) <span class="op">*</span><span class="st"> </span><span class="dv">100</span></a></code></pre></div>
<pre><code>## [1] 112.2817</code></pre>
<p>Les résultats sont très similaires si un modèle temporel est utilisé à la place.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="co"># Indice temporel factice</span></a>
<a class="sourceLine" id="cb37-2" title="2">time_dummy &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(price) <span class="op">~</span><span class="st"> </span>period <span class="op">+</span><span class="st"> </span>liver <span class="op">+</span><span class="st"> </span>salmon, df)</a>
<a class="sourceLine" id="cb37-3" title="3"><span class="kw">exp</span>(<span class="kw">coef</span>(time_dummy)[<span class="dv">2</span>]) <span class="op">*</span><span class="st"> </span><span class="dv">100</span></a></code></pre></div>
<pre><code>##   period 
## 112.2246</code></pre>
<p>L’ajout de pondérations pour les transactions dans chaque strate peut facilement être effectué avec une régression pondérée.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1"><span class="co"># Faites des poids</span></a>
<a class="sourceLine" id="cb39-2" title="2">df<span class="op">$</span>weights &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">25</span> <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">25</span>)</a>
<a class="sourceLine" id="cb39-3" title="3"></a>
<a class="sourceLine" id="cb39-4" title="4"><span class="co"># Calculer l&#39;indice d&#39;imputation hédonique pondéré</span></a>
<a class="sourceLine" id="cb39-5" title="5">hedonic_imputation &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(price) <span class="op">~</span><span class="st"> </span>period <span class="op">+</span><span class="st"> </span>liver <span class="op">+</span><span class="st"> </span>salmon <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb39-6" title="6"><span class="st">                           </span>period<span class="op">:</span>(<span class="kw">I</span>(liver <span class="op">-</span><span class="st"> </span><span class="kw">weighted.mean</span>(liver, weights)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb39-7" title="7"><span class="st">                                   </span><span class="kw">I</span>(salmon <span class="op">-</span><span class="st"> </span><span class="kw">weighted.mean</span>(salmon, weights))), </a>
<a class="sourceLine" id="cb39-8" title="8">                         df, <span class="dt">weights =</span> weights)</a>
<a class="sourceLine" id="cb39-9" title="9"><span class="kw">exp</span>(<span class="kw">coef</span>(hedonic_imputation)[<span class="dv">2</span>]) <span class="op">*</span><span class="st"> </span><span class="dv">100</span></a></code></pre></div>
<pre><code>##   period 
## 111.1855</code></pre>
<p>Cela donne la même réponse que le calcul en deux étapes.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"><span class="co"># Régression période 0</span></a>
<a class="sourceLine" id="cb41-2" title="2">hi0 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(price) <span class="op">~</span><span class="st"> </span>liver <span class="op">+</span><span class="st"> </span>salmon, df, <span class="dt">subset =</span> period <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="dt">weights =</span> weights)</a>
<a class="sourceLine" id="cb41-3" title="3"></a>
<a class="sourceLine" id="cb41-4" title="4"><span class="co"># Régression de la période 1</span></a>
<a class="sourceLine" id="cb41-5" title="5">hi1 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(price) <span class="op">~</span><span class="st"> </span>liver <span class="op">+</span><span class="st"> </span>salmon, df, <span class="dt">subset =</span> period <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">weights =</span> weights)</a>
<a class="sourceLine" id="cb41-6" title="6"></a>
<a class="sourceLine" id="cb41-7" title="7"><span class="co"># Calculer l&#39;indice à l&#39;aide de prix prédits pondérés</span></a>
<a class="sourceLine" id="cb41-8" title="8"><span class="kw">exp</span>(<span class="kw">weighted.mean</span>(<span class="kw">predict</span>(hi1, df) <span class="op">-</span><span class="st"> </span><span class="kw">predict</span>(hi0, df), df<span class="op">$</span>weights)) <span class="op">*</span><span class="st"> </span><span class="dv">100</span></a></code></pre></div>
<pre><code>## [1] 111.1855</code></pre>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="lapproche-temporelle.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="affectation-2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["cours-indices-des-prix.pdf"],
"toc": {
"collapse": "section"
},
"info": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
